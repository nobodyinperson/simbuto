#!/usr/bin/env python3
import sys, os
import logging

logger = logging.getLogger(__name__)

####################
### LIBRARY PATH ###
####################
# add /usr/lib/simbuto/python to the module paths
sys.path.insert(1,"/usr/lib/simbuto/python")
import simbuto.config

################
### LANGUAGE ###
################
simbuto.config.install_language_globally()

#####################
### CONFIGURATION ###
#####################
# make sure, there is a personal configuration folder
simbuto.config.make_sure_there_is_simbuto_dotfolder()
config = simbuto.config.get_personal_configuration()
config.read(["/etc/simbuto/conf/gui.conf"])

####################
### Logger setup ###
####################
simbuto.config.setup_logger_from_config(logger = logger, 
    section="logging", config = config)


logger.info(_("This is simbuto."))
logger.debug(_("command-line: {}").format(sys.argv))
logger.warning(_("simbuto is still in early development phase..."))

###########
### Gui ###
###########
import simbuto.gui
# a gui
gui = simbuto.gui.SimbutoGui()
# set the config
gui.set_config(config)
# set the logger
gui.set_logger(logger)
# set up the gui
gui.setup_gui()

try:
    filename = sys.argv[1]
    logger.info(_("specified file to open via command line: {}").format(
        filename))
    gui.fill_editor_from_file(filename)
except IndexError:
    logger.info(_("no file specified to open via command line"))

# run the gui
gui.run()
